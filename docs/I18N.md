# Paths-LE Internationalization (I18N) Guide

## Goals and philosophy

- Inclusive by default: all user-facing text is localizable.
- Privacy-first and offline: no network calls; translations ship with the extension.
- Predictable keys: two namespaces — `manifest.*` for `package.json` UI and `runtime.*` for in-code strings.
- Safe fallbacks: English is bundled and used when a key or locale is missing.
- Translator-friendly: consistent placeholders, small focused sentences, and a source catalogue.

Non-goals:

- Remote translation fetching or telemetry.
- Complex runtime pluralization logic. We use positional `{0}` placeholders with `vscode-nls`.

---

## File layout

```
src/i18n/
  package.nls.json        # Base English translations
  package.nls.zh-cn.json  # Chinese Simplified
  package.nls.de.json     # German
  package.nls.es.json     # Spanish
  package.nls.fr.json     # French
  package.nls.id.json     # Indonesian
  package.nls.it.json     # Italian
  package.nls.ja.json     # Japanese
  package.nls.ko.json     # Korean
  package.nls.pt-br.json  # Portuguese (Brazil)
  package.nls.ru.json     # Russian
  package.nls.uk.json     # Ukrainian
  package.nls.vi.json     # Vietnamese

package.nls.json          # base English manifest/runtime keys (copied from src/i18n/)
package.json              # wired to l10n field
```

Notes:

- **v1.2.0**: Paths-LE now ships with **13 languages** including English and 12 translations!
- During packaging, localization files are copied from `src/i18n/` to the extension root by the `vscode:prepublish` script.
- VS Code discovers manifest translations based on the `l10n` field in `package.json` and the `package.nls*.json` naming convention.

**Supported Locales (v1.2.0):**

- English (`en`) - Base language
- Chinese Simplified (`zh-cn`), German (`de`), Spanish (`es`), French (`fr`)
- Indonesian (`id`), Italian (`it`), Japanese (`ja`), Korean (`ko`)
- Portuguese-Brazil (`pt-br`), Russian (`ru`), Ukrainian (`uk`), Vietnamese (`vi`)

---

## Key namespaces

### Manifest prefix: `manifest.*`

Used by `package.json` contributions (commands, configuration, menus, capabilities):

```json
{
  "displayName": "%manifest.ext.name%",
  "description": "%manifest.ext.description%",
  "contributes": {
    "commands": [
      {
        "command": "paths-le.extractPaths",
        "title": "%manifest.command.extract.title%",
        "category": "%manifest.command.category%"
      }
    ]
  }
}
```

### Runtime prefix: `runtime.*`

Used in TypeScript code for notifications, prompts, and status messages:

```typescript
import * as nls from 'vscode-nls'
const localize = nls.config({ messageFormat: nls.MessageFormat.file })()

// Usage
deps.notifier.info(
  localize('runtime.message.info.extraction-complete', 'Extracted {0} paths', count),
)
```

---

## Key conventions

### Naming pattern

`<namespace>.<category>.<specific-key>`

Examples:

- `manifest.command.extract.title` → "Extract Paths"
- `runtime.error.parse` → "Failed to parse file: {0}"
- `runtime.progress.extract.title` → "Extracting paths..."
- `runtime.validation.broken-path` → "Broken path: {0}"

### Placeholders

Use positional placeholders `{0}`, `{1}`, etc. for dynamic values:

```typescript
localize('runtime.validation.summary', '{0} of {1} paths are broken', brokenCount, totalCount)
```

Keep placeholders simple:

- Counts: `{0} paths extracted`
- File names: `Failed to parse: {0}`
- Percentages: `Progress: {0}%`
- Paths: `Broken path: {0}`

---

## Adding new strings

### Step 1: Add to `package.nls.json`

```json
{
  "runtime.validation.permission-denied": "Permission denied for path: {0}"
}
```

### Step 2: Use in code

```typescript
import * as nls from 'vscode-nls'
const localize = nls.config({ messageFormat: nls.MessageFormat.file })()

deps.notifier.warn(
  localize('runtime.validation.permission-denied', 'Permission denied for path: {0}', path),
)
```

### Step 3: Test

1. Reload VS Code window
2. Verify the string displays correctly
3. Check Output panel → "Paths-LE" for any localization warnings

---

## Current localization coverage

### Manifest strings (package.json)

- ✅ Extension name and description
- ✅ All command titles and categories
- ✅ All configuration settings descriptions
- ✅ Capability descriptions
- ✅ Keyboard shortcut descriptions
- ✅ Preset mode descriptions

### Runtime strings (TypeScript code)

- ✅ Error messages (parse, validation, safety, operational)
- ✅ Progress indicators
- ✅ Notification messages
- ✅ Validation results
- ✅ Analysis output
- ✅ Performance warnings
- ✅ Safety recommendations
- ✅ Permission error messages

---

## Path-specific localization

### Path validation messages

```json
{
  "runtime.validation.path-exists": "Path exists: {0}",
  "runtime.validation.path-missing": "Path not found: {0}",
  "runtime.validation.path-permission": "Permission denied: {0}",
  "runtime.validation.path-invalid": "Invalid path format: {0}"
}
```

### Path analysis messages

```json
{
  "runtime.analysis.depth": "Path depth: min {0}, max {1}, avg {2}",
  "runtime.analysis.patterns": "Found {0} unique directory patterns",
  "runtime.analysis.naming": "Naming convention: {0} paths use {1}"
}
```

---

## Adding new languages

**Status**: v1.2.0 ships with 13 languages! To add more:

1. Create `src/i18n/package.nls.<locale>.json`
2. Copy all keys from `src/i18n/package.nls.json`
3. Translate values, keeping placeholders unchanged (e.g., `{0}`, `{1}`)
4. Test with VS Code's language picker (`Configure Display Language`)
5. Build and package - `copy:i18n` script automatically copies to extension root

Example structure for a new language:

```json
{
  "manifest.ext.name": "Paths-LE",
  "manifest.ext.description": "File path extraction and analysis from JavaScript, TypeScript, JSON...",
  "runtime.format.javascript.description": "JavaScript/TypeScript files with import/require/export statements",
  "runtime.info.package-filtered": "Filtered {0} package imports (e.g., 'react', 'lodash')"
}
```

**New in v1.2.0**: Added format-specific descriptions and smart filtering messages for all file types.

---

## Testing localization

### Verify English fallback

1. Remove a key from `package.nls.json`
2. Use the key in code
3. Expect: VS Code shows the key name (safe fallback)

### Check placeholder usage

```typescript
// Good
localize('runtime.validation.summary', 'Found {0} broken paths', count)

// Bad - placeholder mismatch
localize('runtime.validation.summary', 'Found broken paths', count)
```

### Output panel debugging

Enable telemetry logging to see localization events:

```json
{
  "paths-le.telemetryEnabled": true
}
```

Check Output panel → "Paths-LE" for warnings about missing keys.

---

## Best practices

### Keep it simple

- Short, focused sentences
- One concept per key
- Avoid complex grammar that doesn't translate well

### Consistent terminology

- "Extract" not "pull" or "get"
- "Paths" not "files" or "locations"
- "Validate" not "check" or "verify"
- "Broken" not "missing" or "invalid" (unless specific)

### Context matters

Provide context in key names:

- `runtime.error.validation` - clearly a validation error
- `runtime.progress.extract.title` - progress indicator title
- `manifest.command.validate.title` - command palette display
- `runtime.validation.permission-denied` - permission-specific error

### Avoid concatenation

Don't build sentences from multiple keys:

```typescript
// Bad
const msg = localize('runtime.found') + count + localize('runtime.paths')

// Good
const msg = localize('runtime.found-paths', 'Found {0} paths', count)
```

### Path-specific considerations

When localizing path-related strings:

- Keep path separators (/, \) untranslated
- Don't translate technical path terms (e.g., "../", "./", "~")
- Preserve path format in placeholders

```typescript
// Good
localize('runtime.validation.relative', 'Relative path detected: {0}', path)

// Bad - don't translate path parts
localize('runtime.validation.relative', 'Relative Pfad detected: ./{0}', path)
```

---

## Resources

- **VS Code I18N Guide:** https://code.visualstudio.com/api/references/extension-manifest#contributes.localizations
- **vscode-nls documentation:** https://github.com/Microsoft/vscode-nls
- **MessageFormat syntax:** https://messageformat.github.io/messageformat/

---

**Current status:** English-only  
**Roadmap:** Multi-language support in v1.1.0+

---

**Project:** [Issues](https://github.com/nolindnaidoo/paths-le/issues) • [Pull Requests](https://github.com/nolindnaidoo/paths-le/pulls) • [Releases](https://github.com/nolindnaidoo/paths-le/releases) • [MIT License](LICENSE)

**Dev:** [Spec](SPECIFICATION.md) • [Architecture](ARCHITECTURE.md) • [Development](DEVELOPMENT.md) • [Testing](TESTING.md)

**Docs:** [Commands](COMMANDS.md) • [Notifications](NOTIFICATIONS.md) • [Config](CONFIGURATION.md) • [Performance](PERFORMANCE.md) • [Privacy](PRIVACY.md)
