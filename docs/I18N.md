# Numbers-LE Internationalization (I18N) Guide

## Goals and philosophy

- Inclusive by default: all user-facing text is localizable.
- Privacy-first and offline: no network calls; translations ship with the extension.
- Predictable keys: two namespaces — `manifest.*` for `package.json` UI and `runtime.*` for in-code strings.
- Safe fallbacks: English is bundled and used when a key or locale is missing.
- Translator-friendly: consistent placeholders, small focused sentences, and a source catalogue.

Non-goals:

- Remote translation fetching or telemetry.
- Complex runtime pluralization logic. We use positional `{0}` placeholders with `vscode-nls`.

---

## File layout

```
src/i18n/
  package.nls.json        # Future: translation files (currently English-only)

package.nls.json          # base English manifest/runtime keys
package.json              # wired to l10n field
```

Notes:

- Currently, Numbers-LE ships with English only. Future releases will include translations.
- During packaging, localization files would be copied to the extension root by the `vscode:prepublish` script.
- VS Code discovers manifest translations based on the `l10n` field in `package.json` and the `package.nls*.json` naming convention.

**Future locales planned:**

- German (`de`), Spanish (`es`), French (`fr`), Italian (`it`), Japanese (`ja`), Korean (`ko`)
- Portuguese-Brazil (`pt-br`), Russian (`ru`), Ukrainian (`uk`), Vietnamese (`vi`), Chinese-Simplified (`zh-cn`)

---

## Key namespaces

### Manifest prefix: `manifest.*`

Used by `package.json` contributions (commands, configuration, menus, capabilities):

```json
{
  "displayName": "%manifest.ext.name%",
  "description": "%manifest.ext.description%",
  "contributes": {
    "commands": [
      {
        "command": "numbers-le.extractNumbers",
        "title": "%manifest.command.extract.title%",
        "category": "%manifest.command.category%"
      }
    ]
  }
}
```

### Runtime prefix: `runtime.*`

Used in TypeScript code for notifications, prompts, and status messages:

```typescript
import * as nls from "vscode-nls";
const localize = nls.config({ messageFormat: nls.MessageFormat.file })();

// Usage
deps.notifier.info(
  localize(
    "runtime.message.info.extraction-complete",
    "Extracted {0} numbers",
    count
  )
);
```

---

## Key conventions

### Naming pattern

`<namespace>.<category>.<specific-key>`

Examples:

- `manifest.command.extract.title` → "Extract Numbers"
- `runtime.error.parse` → "Failed to parse file: {0}"
- `runtime.progress.extract.title` → "Extracting numbers..."

### Placeholders

Use positional placeholders `{0}`, `{1}`, etc. for dynamic values:

```typescript
localize(
  "runtime.error.file-too-large",
  "File size ({0} MB) exceeds threshold",
  fileSize
);
```

Keep placeholders simple:

- Numbers: `{0} numbers extracted`
- File names: `Failed to parse: {0}`
- Percentages: `Progress: {0}%`

---

## Adding new strings

### Step 1: Add to `package.nls.json`

```json
{
  "runtime.new.feature.message": "New feature activated with {0} items"
}
```

### Step 2: Use in code

```typescript
import * as nls from "vscode-nls";
const localize = nls.config({ messageFormat: nls.MessageFormat.file })();

deps.notifier.info(
  localize(
    "runtime.new.feature.message",
    "New feature activated with {0} items",
    itemCount
  )
);
```

### Step 3: Test

1. Reload VS Code window
2. Verify the string displays correctly
3. Check Output panel → "Numbers-LE" for any localization warnings

---

## Current localization coverage

### Manifest strings (package.json)

- ✅ Extension name and description
- ✅ All command titles and categories
- ✅ All configuration settings descriptions
- ✅ Capability descriptions

### Runtime strings (TypeScript code)

- ✅ Error messages (parse, validation, safety, operational)
- ✅ Progress indicators
- ✅ Notification messages
- ✅ Performance warnings
- ✅ Safety recommendations

---

## Future expansion

When adding new languages:

1. Create `package.nls.<locale>.json` files
2. Copy all keys from `package.nls.json`
3. Translate values, keeping placeholders unchanged
4. Add to `copy:i18n` script in `package.json`
5. Test with VS Code's language picker

Example structure for German:

```json
{
  "manifest.ext.name": "Numbers-LE",
  "manifest.ext.description": "Null Aufwand Nummern Extraktion...",
  "runtime.error.parse": "Fehler beim Parsen der Datei: {0}"
}
```

---

## Testing localization

### Verify English fallback

1. Remove a key from `package.nls.json`
2. Use the key in code
3. Expect: VS Code shows the key name (safe fallback)

### Check placeholder usage

```typescript
// Good
localize("runtime.message", "Found {0} items", count);

// Bad - placeholder mismatch
localize("runtime.message", "Found items", count);
```

### Output panel debugging

Enable telemetry logging to see localization events:

```json
{
  "numbers-le.telemetryEnabled": true
}
```

Check Output panel → "Numbers-LE" for warnings about missing keys.

---

## Best practices

### Keep it simple

- Short, focused sentences
- One concept per key
- Avoid complex grammar that doesn't translate well

### Consistent terminology

- "Extract" not "pull" or "get"
- "Numbers" not "values" or "numerics"
- "File" not "document" or "resource"

### Context matters

Provide context in key names:

- `runtime.error.parse` - clearly an error
- `runtime.progress.extract.title` - progress indicator title
- `manifest.command.extract.title` - command palette display

### Avoid concatenation

Don't build sentences from multiple keys:

```typescript
// Bad
const msg = localize("runtime.found") + count + localize("runtime.numbers");

// Good
const msg = localize("runtime.found-numbers", "Found {0} numbers", count);
```

---

## Resources

- **VS Code I18N Guide:** https://code.visualstudio.com/api/references/extension-manifest#contributes.localizations
- **vscode-nls documentation:** https://github.com/Microsoft/vscode-nls
- **MessageFormat syntax:** https://messageformat.github.io/messageformat/

---

**Current status:** English-only  
**Roadmap:** Multi-language support in v1.1.0+
